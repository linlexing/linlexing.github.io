软件开发之浅见
========================

2017-05-13
------------------------

自1999年起，一直从事软件开发，至今仍编码的同学、朋友，寥寥无几，历多年而趣不怠，现将多年感悟成文以记。

软件开发第一条：不时学习，不断进步。高中时，即学软件开发，兴趣盎然，后一直保持兴趣不减，视学为乐。

综看国内，多数软件公司从事应用软件开发，转换现实业务逻辑至计算机程序中，具有技术难度不高，而变化剧烈的特征。应用软件前期拼功能，后期拼性能稳定性。

软件开发久了，都会积累一些工具库，代码库，经过多年后，大家都会意识到要有一个框架或平台，来完成通用的功能。

所谓框架，就是一系列约束和规则，来约定新功能怎么开发，旧功能如何修改；所谓平台，是在框架基础上，提供一系列辅助工具，完成开发。而SDK处于框架之下，提供基础功能。

从底层看，SDK提供业务无关的基础功能，框架提供某个领域通用的约束，平台则具化框架。

软件开发的难点，在于变化，变化分用户需求变化和技术改变。用户需求时时在变化，技术改变一般五年一轮。因此，框架应满足这两者变化，提供机制，可以快速调整用户需求，尽量采用稳固的底层技术，延长技术改变周期。

用户需求的变化，大多以界面为依托提出，因此，框架首要解决的是界面如何搭建；界面是最容易变化的部分，因此，需采用能快速更新替换的方案，从目前看，HTML5是一个好选择。

其次，目前主流存贮还是关系数据库，其结构的变化，需定制脚本运行，不如替换程序文件来的简单，框架应当能提供便利，当结构变化时，不需或减少人工参与，自动完成调整。

再者，云技术兴起，未来下一次的技术变革，很可能就是关系数据库，关系数据库不会消失，但是会有一些新的约束出现，因此，框架应隔离数据库的各自的特性，方便后端数据库更换。

业务逻辑也是变化最激烈的部分，多数的业务逻辑较简单，但会有一些非常有深度，超出或触碰到当前技术屋顶，因此，框架应提供两种方式编写业务逻辑，常规用能快速发布的脚本语言，复杂的，用插件的方式，做深入开发。

以上，是解决功能和投入的矛盾，用最少的投入，开发最多的功能。但当一个产品运行多年，最终会碰到两大难题：性能、稳定性。后期，用户需求趋于稳定，流程不可简化，功能不需增加时，会转向使用便捷，希望用最少的时间完成工作，系统运行的速度就会用来比较，框架应提供水平、垂直扩展的机制。而稳定性，则需注意技术选型，框架应慎重采用第三方库，无必要的情况，均需自行编写代码，因为在实际开发过程中，排解BUG时，很难界定BUG点是在第三方库中，还是在自有代码中，所浪费的时间，足够编写功能。同时，应注意模块的隔离，严格控制公共库数量，特别是业务公共库。

当框架成熟后，可在其上开发平台，注意平台所提供的功能，最好能自举，这样开发平台的过程中，会自然对框架做细致的调整。

有一些目标，我认为是必须要达到的：

1. 界面与业务逻辑的分离，界面控制与业务逻辑，两者一定要分开，宁可将业务逻辑封装至后端服务中
2. 存贮层的弱化，从云技术发展看，存贮技术未来变化比较大，业务逻辑不可放入数据库中，数据库应当只提供基本的存贮功能
3. 版本管理的介入，所有的配置、代码需纳入git软件管理，即所有定制的内容保存在磁盘目录中，不可存入数据库
4. 提供树状的功能体系，即逐级添加功能，通用功能放上级
5. 提供无人值守的升级，即不需人工干预，完成程序更新、数据库更新、通用数据更新等所有操作

推荐框架：

前端采用webview加壳的方式，壳主要提供本地系统的访问，一般不用变动,webview载入web服务器上的页面；web服务器即框架核心，对前端提供web服务，并调用后端的业务逻辑，后端业务逻辑再调用数据库存贮数据。

对于不同规模的团队，应采用不同的框架，小规模的，业务逻辑可与web服务合一起，大规模且人员流动频繁的，后端业务逻辑与前端界面可分开，中间用gRPC调用。

框架最应该实现的功能是热部署，即不停止业务系统的情况下，能实时将版本更新。这样才能做到快速反应，提高生产效率！